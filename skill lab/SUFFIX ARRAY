#include <stdio.h>
#include <string.h>
#include <stdlib.h>

struct Suffix {
    char *suffix;
    int index;
};

int compareSuffixes(const void *a, const void *b) {
    return strcmp(((struct Suffix *)a)->suffix, ((struct Suffix *)b)->suffix);
}

int *buildSuffixArray(char *text, int length) {
    struct Suffix suffixes[length];
    for (int i = 0; i < length; i++) {
        suffixes[i].suffix = text + i;
        suffixes[i].index = i;
    }

    qsort(suffixes, length, sizeof(struct Suffix), compareSuffixes);

    int *suffixArray = (int *)malloc(length * sizeof(int));
    for (int i = 0; i < length; i++) {
        suffixArray[i] = suffixes[i].index;
    }

    free(suffixes);

    return suffixArray;
}

void printSuffixArray(char *text, int *suffixArray, int length) {
    printf("Suffix Array for '%s':\n", text);
    for (int i = 0; i < length; i++) {
        printf("%d: %s\n", suffixArray[i], text + suffixArray[i]);
    }
}

int main() {
    char text[] = "abracadabra";
    int length = strlen(text);

    int *suffixArray = buildSuffixArray(text, length);

    printSuffixArray(text, suffixArray, length);

    free(suffixArray);

    return 0;}
